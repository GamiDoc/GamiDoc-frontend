{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\").default;\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\").default;\n\nexports.__esModule = true;\nexports.default = void 0;\n\nvar _extends2 = _interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));\n\nvar R = _interopRequireWildcard(require(\"ramda\"));\n\nvar P = _interopRequireWildcard(require(\"@react-pdf/primitives\"));\n\nvar _attributedString = _interopRequireDefault(require(\"@react-pdf/textkit/lib/attributedString\"));\n\nvar _emoji = require(\"./emoji\");\n\nvar _ignoreChars = _interopRequireDefault(require(\"./ignoreChars\"));\n\nvar _transformText = _interopRequireDefault(require(\"./transformText\"));\n\nvar PREPROCESSORS = [_ignoreChars.default, _emoji.embedEmojis];\nvar isType = R.propEq('type');\nvar isImage = isType(P.Image);\nvar isTextInstance = isType(P.TextInstance);\n/**\n * Get textkit fragments of given node object\n *\n * @param {Object} font store\n * @param {Object} instance node\n * @returns {Array} text fragments\n */\n\nvar getFragments = function getFragments(fontStore, instance, parentLink, level) {\n  var _instance$props, _instance$props2;\n\n  if (level === void 0) {\n    level = 0;\n  }\n\n  if (!instance) return [{\n    string: ''\n  }];\n  var fragments = [];\n  var _instance$style = instance.style,\n      _instance$style$color = _instance$style.color,\n      color = _instance$style$color === void 0 ? 'black' : _instance$style$color,\n      _instance$style$fontF = _instance$style.fontFamily,\n      fontFamily = _instance$style$fontF === void 0 ? 'Helvetica' : _instance$style$fontF,\n      fontWeight = _instance$style.fontWeight,\n      fontStyle = _instance$style.fontStyle,\n      _instance$style$fontS = _instance$style.fontSize,\n      fontSize = _instance$style$fontS === void 0 ? 18 : _instance$style$fontS,\n      _instance$style$textA = _instance$style.textAlign,\n      textAlign = _instance$style$textA === void 0 ? 'left' : _instance$style$textA,\n      lineHeight = _instance$style.lineHeight,\n      textDecoration = _instance$style.textDecoration,\n      textDecorationColor = _instance$style.textDecorationColor,\n      textDecorationStyle = _instance$style.textDecorationStyle,\n      textTransform = _instance$style.textTransform,\n      letterSpacing = _instance$style.letterSpacing,\n      textIndent = _instance$style.textIndent,\n      opacity = _instance$style.opacity;\n  var opts = {\n    fontFamily: fontFamily,\n    fontWeight: fontWeight,\n    fontStyle: fontStyle\n  };\n  var obj = fontStore ? fontStore.getFont(opts) : null;\n  var font = obj ? obj.data : fontFamily; // Don't pass main background color to textkit. Will be rendered by the render package instead\n\n  var backgroundColor = level === 0 ? null : instance.style.backgroundColor;\n  var attributes = {\n    font: font,\n    color: color,\n    opacity: opacity,\n    fontSize: fontSize,\n    backgroundColor: backgroundColor,\n    align: textAlign,\n    indent: textIndent,\n    characterSpacing: letterSpacing,\n    strikeStyle: textDecorationStyle,\n    underlineStyle: textDecorationStyle,\n    underline: textDecoration === 'underline' || textDecoration === 'underline line-through' || textDecoration === 'line-through underline',\n    strike: textDecoration === 'line-through' || textDecoration === 'underline line-through' || textDecoration === 'line-through underline',\n    strikeColor: textDecorationColor || color,\n    underlineColor: textDecorationColor || color,\n    link: parentLink || ((_instance$props = instance.props) === null || _instance$props === void 0 ? void 0 : _instance$props.src) || ((_instance$props2 = instance.props) === null || _instance$props2 === void 0 ? void 0 : _instance$props2.href),\n    lineHeight: lineHeight ? lineHeight * fontSize : null\n  };\n\n  for (var i = 0; i < instance.children.length; i += 1) {\n    var child = instance.children[i];\n\n    if (isImage(child)) {\n      fragments.push({\n        string: String.fromCharCode(0xfffc),\n        attributes: (0, _extends2.default)({}, attributes, {\n          attachment: {\n            width: child.style.width || fontSize,\n            height: child.style.height || fontSize,\n            image: child.image.data\n          }\n        })\n      });\n    } else if (isTextInstance(child)) {\n      fragments.push({\n        string: (0, _transformText.default)(child.value, textTransform),\n        attributes: attributes\n      });\n    } else if (child) {\n      var _fragments;\n\n      (_fragments = fragments).push.apply(_fragments, getFragments(fontStore, child, attributes.link, level + 1));\n    }\n  }\n\n  for (var _i = 0; _i < PREPROCESSORS.length; _i += 1) {\n    var preprocessor = PREPROCESSORS[_i];\n    fragments = preprocessor(fragments);\n  }\n\n  return fragments;\n};\n/**\n * Get textkit attributed string from text node\n *\n * @param {Object} font store\n * @param {Object} instance node\n * @returns {Object} attributed string\n */\n\n\nvar getAttributedString = function getAttributedString(fontStore, instance) {\n  var fragments = getFragments(fontStore, instance);\n  return _attributedString.default.fromFragments(fragments);\n};\n\nvar _default = R.curryN(2, getAttributedString);\n\nexports.default = _default;","map":{"version":3,"names":["_interopRequireWildcard","require","default","_interopRequireDefault","exports","__esModule","_extends2","R","P","_attributedString","_emoji","_ignoreChars","_transformText","PREPROCESSORS","embedEmojis","isType","propEq","isImage","Image","isTextInstance","TextInstance","getFragments","fontStore","instance","parentLink","level","_instance$props","_instance$props2","string","fragments","_instance$style","style","_instance$style$color","color","_instance$style$fontF","fontFamily","fontWeight","fontStyle","_instance$style$fontS","fontSize","_instance$style$textA","textAlign","lineHeight","textDecoration","textDecorationColor","textDecorationStyle","textTransform","letterSpacing","textIndent","opacity","opts","obj","getFont","font","data","backgroundColor","attributes","align","indent","characterSpacing","strikeStyle","underlineStyle","underline","strike","strikeColor","underlineColor","link","props","src","href","i","children","length","child","push","String","fromCharCode","attachment","width","height","image","value","_fragments","apply","_i","preprocessor","getAttributedString","fromFragments","_default","curryN"],"sources":["/home/carlobottaro/Documents/UniversitÃ /gamification/node_modules/@react-pdf/layout/lib/text/getAttributedString.js"],"sourcesContent":["\"use strict\";\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\").default;\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\").default;\n\nexports.__esModule = true;\nexports.default = void 0;\n\nvar _extends2 = _interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));\n\nvar R = _interopRequireWildcard(require(\"ramda\"));\n\nvar P = _interopRequireWildcard(require(\"@react-pdf/primitives\"));\n\nvar _attributedString = _interopRequireDefault(require(\"@react-pdf/textkit/lib/attributedString\"));\n\nvar _emoji = require(\"./emoji\");\n\nvar _ignoreChars = _interopRequireDefault(require(\"./ignoreChars\"));\n\nvar _transformText = _interopRequireDefault(require(\"./transformText\"));\n\nvar PREPROCESSORS = [_ignoreChars.default, _emoji.embedEmojis];\nvar isType = R.propEq('type');\nvar isImage = isType(P.Image);\nvar isTextInstance = isType(P.TextInstance);\n/**\n * Get textkit fragments of given node object\n *\n * @param {Object} font store\n * @param {Object} instance node\n * @returns {Array} text fragments\n */\n\nvar getFragments = function getFragments(fontStore, instance, parentLink, level) {\n  var _instance$props, _instance$props2;\n\n  if (level === void 0) {\n    level = 0;\n  }\n\n  if (!instance) return [{\n    string: ''\n  }];\n  var fragments = [];\n  var _instance$style = instance.style,\n      _instance$style$color = _instance$style.color,\n      color = _instance$style$color === void 0 ? 'black' : _instance$style$color,\n      _instance$style$fontF = _instance$style.fontFamily,\n      fontFamily = _instance$style$fontF === void 0 ? 'Helvetica' : _instance$style$fontF,\n      fontWeight = _instance$style.fontWeight,\n      fontStyle = _instance$style.fontStyle,\n      _instance$style$fontS = _instance$style.fontSize,\n      fontSize = _instance$style$fontS === void 0 ? 18 : _instance$style$fontS,\n      _instance$style$textA = _instance$style.textAlign,\n      textAlign = _instance$style$textA === void 0 ? 'left' : _instance$style$textA,\n      lineHeight = _instance$style.lineHeight,\n      textDecoration = _instance$style.textDecoration,\n      textDecorationColor = _instance$style.textDecorationColor,\n      textDecorationStyle = _instance$style.textDecorationStyle,\n      textTransform = _instance$style.textTransform,\n      letterSpacing = _instance$style.letterSpacing,\n      textIndent = _instance$style.textIndent,\n      opacity = _instance$style.opacity;\n  var opts = {\n    fontFamily: fontFamily,\n    fontWeight: fontWeight,\n    fontStyle: fontStyle\n  };\n  var obj = fontStore ? fontStore.getFont(opts) : null;\n  var font = obj ? obj.data : fontFamily; // Don't pass main background color to textkit. Will be rendered by the render package instead\n\n  var backgroundColor = level === 0 ? null : instance.style.backgroundColor;\n  var attributes = {\n    font: font,\n    color: color,\n    opacity: opacity,\n    fontSize: fontSize,\n    backgroundColor: backgroundColor,\n    align: textAlign,\n    indent: textIndent,\n    characterSpacing: letterSpacing,\n    strikeStyle: textDecorationStyle,\n    underlineStyle: textDecorationStyle,\n    underline: textDecoration === 'underline' || textDecoration === 'underline line-through' || textDecoration === 'line-through underline',\n    strike: textDecoration === 'line-through' || textDecoration === 'underline line-through' || textDecoration === 'line-through underline',\n    strikeColor: textDecorationColor || color,\n    underlineColor: textDecorationColor || color,\n    link: parentLink || ((_instance$props = instance.props) === null || _instance$props === void 0 ? void 0 : _instance$props.src) || ((_instance$props2 = instance.props) === null || _instance$props2 === void 0 ? void 0 : _instance$props2.href),\n    lineHeight: lineHeight ? lineHeight * fontSize : null\n  };\n\n  for (var i = 0; i < instance.children.length; i += 1) {\n    var child = instance.children[i];\n\n    if (isImage(child)) {\n      fragments.push({\n        string: String.fromCharCode(0xfffc),\n        attributes: (0, _extends2.default)({}, attributes, {\n          attachment: {\n            width: child.style.width || fontSize,\n            height: child.style.height || fontSize,\n            image: child.image.data\n          }\n        })\n      });\n    } else if (isTextInstance(child)) {\n      fragments.push({\n        string: (0, _transformText.default)(child.value, textTransform),\n        attributes: attributes\n      });\n    } else if (child) {\n      var _fragments;\n\n      (_fragments = fragments).push.apply(_fragments, getFragments(fontStore, child, attributes.link, level + 1));\n    }\n  }\n\n  for (var _i = 0; _i < PREPROCESSORS.length; _i += 1) {\n    var preprocessor = PREPROCESSORS[_i];\n    fragments = preprocessor(fragments);\n  }\n\n  return fragments;\n};\n/**\n * Get textkit attributed string from text node\n *\n * @param {Object} font store\n * @param {Object} instance node\n * @returns {Object} attributed string\n */\n\n\nvar getAttributedString = function getAttributedString(fontStore, instance) {\n  var fragments = getFragments(fontStore, instance);\n  return _attributedString.default.fromFragments(fragments);\n};\n\nvar _default = R.curryN(2, getAttributedString);\n\nexports.default = _default;"],"mappings":"AAAA;;AAEA,IAAIA,uBAAuB,GAAGC,OAAO,CAAC,+CAAD,CAAP,CAAyDC,OAAvF;;AAEA,IAAIC,sBAAsB,GAAGF,OAAO,CAAC,8CAAD,CAAP,CAAwDC,OAArF;;AAEAE,OAAO,CAACC,UAAR,GAAqB,IAArB;AACAD,OAAO,CAACF,OAAR,GAAkB,KAAK,CAAvB;;AAEA,IAAII,SAAS,GAAGH,sBAAsB,CAACF,OAAO,CAAC,gCAAD,CAAR,CAAtC;;AAEA,IAAIM,CAAC,GAAGP,uBAAuB,CAACC,OAAO,CAAC,OAAD,CAAR,CAA/B;;AAEA,IAAIO,CAAC,GAAGR,uBAAuB,CAACC,OAAO,CAAC,uBAAD,CAAR,CAA/B;;AAEA,IAAIQ,iBAAiB,GAAGN,sBAAsB,CAACF,OAAO,CAAC,yCAAD,CAAR,CAA9C;;AAEA,IAAIS,MAAM,GAAGT,OAAO,CAAC,SAAD,CAApB;;AAEA,IAAIU,YAAY,GAAGR,sBAAsB,CAACF,OAAO,CAAC,eAAD,CAAR,CAAzC;;AAEA,IAAIW,cAAc,GAAGT,sBAAsB,CAACF,OAAO,CAAC,iBAAD,CAAR,CAA3C;;AAEA,IAAIY,aAAa,GAAG,CAACF,YAAY,CAACT,OAAd,EAAuBQ,MAAM,CAACI,WAA9B,CAApB;AACA,IAAIC,MAAM,GAAGR,CAAC,CAACS,MAAF,CAAS,MAAT,CAAb;AACA,IAAIC,OAAO,GAAGF,MAAM,CAACP,CAAC,CAACU,KAAH,CAApB;AACA,IAAIC,cAAc,GAAGJ,MAAM,CAACP,CAAC,CAACY,YAAH,CAA3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,IAAIC,YAAY,GAAG,SAASA,YAAT,CAAsBC,SAAtB,EAAiCC,QAAjC,EAA2CC,UAA3C,EAAuDC,KAAvD,EAA8D;EAC/E,IAAIC,eAAJ,EAAqBC,gBAArB;;EAEA,IAAIF,KAAK,KAAK,KAAK,CAAnB,EAAsB;IACpBA,KAAK,GAAG,CAAR;EACD;;EAED,IAAI,CAACF,QAAL,EAAe,OAAO,CAAC;IACrBK,MAAM,EAAE;EADa,CAAD,CAAP;EAGf,IAAIC,SAAS,GAAG,EAAhB;EACA,IAAIC,eAAe,GAAGP,QAAQ,CAACQ,KAA/B;EAAA,IACIC,qBAAqB,GAAGF,eAAe,CAACG,KAD5C;EAAA,IAEIA,KAAK,GAAGD,qBAAqB,KAAK,KAAK,CAA/B,GAAmC,OAAnC,GAA6CA,qBAFzD;EAAA,IAGIE,qBAAqB,GAAGJ,eAAe,CAACK,UAH5C;EAAA,IAIIA,UAAU,GAAGD,qBAAqB,KAAK,KAAK,CAA/B,GAAmC,WAAnC,GAAiDA,qBAJlE;EAAA,IAKIE,UAAU,GAAGN,eAAe,CAACM,UALjC;EAAA,IAMIC,SAAS,GAAGP,eAAe,CAACO,SANhC;EAAA,IAOIC,qBAAqB,GAAGR,eAAe,CAACS,QAP5C;EAAA,IAQIA,QAAQ,GAAGD,qBAAqB,KAAK,KAAK,CAA/B,GAAmC,EAAnC,GAAwCA,qBARvD;EAAA,IASIE,qBAAqB,GAAGV,eAAe,CAACW,SAT5C;EAAA,IAUIA,SAAS,GAAGD,qBAAqB,KAAK,KAAK,CAA/B,GAAmC,MAAnC,GAA4CA,qBAV5D;EAAA,IAWIE,UAAU,GAAGZ,eAAe,CAACY,UAXjC;EAAA,IAYIC,cAAc,GAAGb,eAAe,CAACa,cAZrC;EAAA,IAaIC,mBAAmB,GAAGd,eAAe,CAACc,mBAb1C;EAAA,IAcIC,mBAAmB,GAAGf,eAAe,CAACe,mBAd1C;EAAA,IAeIC,aAAa,GAAGhB,eAAe,CAACgB,aAfpC;EAAA,IAgBIC,aAAa,GAAGjB,eAAe,CAACiB,aAhBpC;EAAA,IAiBIC,UAAU,GAAGlB,eAAe,CAACkB,UAjBjC;EAAA,IAkBIC,OAAO,GAAGnB,eAAe,CAACmB,OAlB9B;EAmBA,IAAIC,IAAI,GAAG;IACTf,UAAU,EAAEA,UADH;IAETC,UAAU,EAAEA,UAFH;IAGTC,SAAS,EAAEA;EAHF,CAAX;EAKA,IAAIc,GAAG,GAAG7B,SAAS,GAAGA,SAAS,CAAC8B,OAAV,CAAkBF,IAAlB,CAAH,GAA6B,IAAhD;EACA,IAAIG,IAAI,GAAGF,GAAG,GAAGA,GAAG,CAACG,IAAP,GAAcnB,UAA5B,CApC+E,CAoCvC;;EAExC,IAAIoB,eAAe,GAAG9B,KAAK,KAAK,CAAV,GAAc,IAAd,GAAqBF,QAAQ,CAACQ,KAAT,CAAewB,eAA1D;EACA,IAAIC,UAAU,GAAG;IACfH,IAAI,EAAEA,IADS;IAEfpB,KAAK,EAAEA,KAFQ;IAGfgB,OAAO,EAAEA,OAHM;IAIfV,QAAQ,EAAEA,QAJK;IAKfgB,eAAe,EAAEA,eALF;IAMfE,KAAK,EAAEhB,SANQ;IAOfiB,MAAM,EAAEV,UAPO;IAQfW,gBAAgB,EAAEZ,aARH;IASfa,WAAW,EAAEf,mBATE;IAUfgB,cAAc,EAAEhB,mBAVD;IAWfiB,SAAS,EAAEnB,cAAc,KAAK,WAAnB,IAAkCA,cAAc,KAAK,wBAArD,IAAiFA,cAAc,KAAK,wBAXhG;IAYfoB,MAAM,EAAEpB,cAAc,KAAK,cAAnB,IAAqCA,cAAc,KAAK,wBAAxD,IAAoFA,cAAc,KAAK,wBAZhG;IAafqB,WAAW,EAAEpB,mBAAmB,IAAIX,KAbrB;IAcfgC,cAAc,EAAErB,mBAAmB,IAAIX,KAdxB;IAefiC,IAAI,EAAE1C,UAAU,KAAK,CAACE,eAAe,GAAGH,QAAQ,CAAC4C,KAA5B,MAAuC,IAAvC,IAA+CzC,eAAe,KAAK,KAAK,CAAxE,GAA4E,KAAK,CAAjF,GAAqFA,eAAe,CAAC0C,GAA1G,CAAV,KAA6H,CAACzC,gBAAgB,GAAGJ,QAAQ,CAAC4C,KAA7B,MAAwC,IAAxC,IAAgDxC,gBAAgB,KAAK,KAAK,CAA1E,GAA8E,KAAK,CAAnF,GAAuFA,gBAAgB,CAAC0C,IAArO,CAfS;IAgBf3B,UAAU,EAAEA,UAAU,GAAGA,UAAU,GAAGH,QAAhB,GAA2B;EAhBlC,CAAjB;;EAmBA,KAAK,IAAI+B,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG/C,QAAQ,CAACgD,QAAT,CAAkBC,MAAtC,EAA8CF,CAAC,IAAI,CAAnD,EAAsD;IACpD,IAAIG,KAAK,GAAGlD,QAAQ,CAACgD,QAAT,CAAkBD,CAAlB,CAAZ;;IAEA,IAAIrD,OAAO,CAACwD,KAAD,CAAX,EAAoB;MAClB5C,SAAS,CAAC6C,IAAV,CAAe;QACb9C,MAAM,EAAE+C,MAAM,CAACC,YAAP,CAAoB,MAApB,CADK;QAEbpB,UAAU,EAAE,CAAC,GAAGlD,SAAS,CAACJ,OAAd,EAAuB,EAAvB,EAA2BsD,UAA3B,EAAuC;UACjDqB,UAAU,EAAE;YACVC,KAAK,EAAEL,KAAK,CAAC1C,KAAN,CAAY+C,KAAZ,IAAqBvC,QADlB;YAEVwC,MAAM,EAAEN,KAAK,CAAC1C,KAAN,CAAYgD,MAAZ,IAAsBxC,QAFpB;YAGVyC,KAAK,EAAEP,KAAK,CAACO,KAAN,CAAY1B;UAHT;QADqC,CAAvC;MAFC,CAAf;IAUD,CAXD,MAWO,IAAInC,cAAc,CAACsD,KAAD,CAAlB,EAA2B;MAChC5C,SAAS,CAAC6C,IAAV,CAAe;QACb9C,MAAM,EAAE,CAAC,GAAGhB,cAAc,CAACV,OAAnB,EAA4BuE,KAAK,CAACQ,KAAlC,EAAyCnC,aAAzC,CADK;QAEbU,UAAU,EAAEA;MAFC,CAAf;IAID,CALM,MAKA,IAAIiB,KAAJ,EAAW;MAChB,IAAIS,UAAJ;;MAEA,CAACA,UAAU,GAAGrD,SAAd,EAAyB6C,IAAzB,CAA8BS,KAA9B,CAAoCD,UAApC,EAAgD7D,YAAY,CAACC,SAAD,EAAYmD,KAAZ,EAAmBjB,UAAU,CAACU,IAA9B,EAAoCzC,KAAK,GAAG,CAA5C,CAA5D;IACD;EACF;;EAED,KAAK,IAAI2D,EAAE,GAAG,CAAd,EAAiBA,EAAE,GAAGvE,aAAa,CAAC2D,MAApC,EAA4CY,EAAE,IAAI,CAAlD,EAAqD;IACnD,IAAIC,YAAY,GAAGxE,aAAa,CAACuE,EAAD,CAAhC;IACAvD,SAAS,GAAGwD,YAAY,CAACxD,SAAD,CAAxB;EACD;;EAED,OAAOA,SAAP;AACD,CA1FD;AA2FA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,IAAIyD,mBAAmB,GAAG,SAASA,mBAAT,CAA6BhE,SAA7B,EAAwCC,QAAxC,EAAkD;EAC1E,IAAIM,SAAS,GAAGR,YAAY,CAACC,SAAD,EAAYC,QAAZ,CAA5B;EACA,OAAOd,iBAAiB,CAACP,OAAlB,CAA0BqF,aAA1B,CAAwC1D,SAAxC,CAAP;AACD,CAHD;;AAKA,IAAI2D,QAAQ,GAAGjF,CAAC,CAACkF,MAAF,CAAS,CAAT,EAAYH,mBAAZ,CAAf;;AAEAlF,OAAO,CAACF,OAAR,GAAkBsF,QAAlB"},"metadata":{},"sourceType":"script"}